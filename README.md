# 실습

## 요구사항 명세

- 회원가입 기능
  - 회원가입을 할 때 이메일, 비밀번호, 이름, 나이의 정보를 받는다.
- 로그인 기능
  - 로그인할 때 이메일, 비밀번호를 활용해서 로그인한다.
- 게시글 작성 기능
  - 로그인한 사용자만 게시글을 작성할 수 있다.
  - 게시글에는 제목과 내용을 작성할 수 있고, 해시태그를 달 수 있고, 게시글의 카테고리(정보 게시글, 홍보 게시글 등)를 고를 수 있다.
- 게시글 조회 기능
  - 작성자, 게시글 제목, 게시글 내용, 게시글 작성 시간, 좋아요 수, 조회 수를 조회할 수 있어야 한다.
- 해시태그로 게시글 조회 기능
  - 특정 해시태그를 가진 모든 게시글을 조회할 수 있어야 한다.
- 좋아요 기능
  - 로그인한 사용자가 특정 게시글에 좋아요를 누를 수 있다.
  - 로그인한 사용자가 특정 게시글에 좋아요 취소를 할 수 있다.
  - 특정 게시글에 어떤 사용자들이 좋아요를 눌렀는 지 조회할 수 있어야 한다.
- 팔로우 기능
  - 특정 사용자가 다른 사용자를 팔로우 할 수 있다.
  - 특정 사용자가 다른 사용자를 언팔로우 할 수 있다.
  - 각 사용자의 팔로우 수를 조회할 수 있어야 한다.
- 신고 기능
  - 로그인한 사용자가 특정 게시글을 신고할 수 있다.
  - 신고할 때 신고 사유를 작성해야 한다.

## DB 설계 과정

### 1. 저장할 데이터를 파악해 보자.

- 이메일, 비밀번호, 이름, 나이
- 게시글 제목, 게시글 내용, 게시글 해시태그, 게시글 카테고리
- 작성자, 게시글 작성 시간, 좋아요 수, 조회 수
- 팔로우 명단, 팔로우 수,
- 신고, 신고 사유, 신고 게시글

### 2. 그룹핑 진행

- https://app.diagrams.net (도구)
- 이메일, 이름, 나이, 비밀번호 : `사용자`
- 내용, 제목, 시간,해시태그, 좋아요 수, 작성자, 조회수, 카테고리 : `게시글`
- 누가 팔로우를 했는지 명단, 누구를 팔로우 했는지 : `팔로우`
- 신고 작성자, 신고 대상 게시글, 신고 사유 : `신고`
- 엑셀, 구글 시트 등을 표작업을 함.
- https://docs.google.com/spreadsheets/d/1PjX6Sepcg3nVyHcGmYTeMgkz_9uw-6aZZbLbqfhALtU/edit?pli=1&gid=1757449023#gid=1757449023

### 3. 각각의 테이블에서 각 내용 체크를 해본다.

- `데이터가 중복되면 안된다.`
- `하나의 값에 여러 개가 들어가면 안된다.`
- 위 내용을 테스트하기 위해서는 더미 데이터 3~4개를 입력해서 테스트한다.

### 4. 사용자 테이블 테스트 해 보기

- 가짜 데이터 3~4 개를 넣어보면서 잘 구성하였는지 검토

- 이메일 항목은 중복되지 않는다
- 이메일 값으로 한개만 받는다

- 비밀번호, 이름, 나이 항목은 중복을 허용해도 된다 (하나의 값이 바뀌어도 다른 값은 영향이 없음)
- 비밀번호, 이름, 나이 값으로 한개만 받는다

- `결론적으로 잘 설계가 되었음.` 을 확정함

### 5. 게시글 테이블 테스트 해 보기

- 내용, 제목, 시간은 중복을 허용해도 된다 (하나의 값이 바뀌어도 다른 값은 영향이 없음)
- 내용, 제목, 시간은 값으로 한개만 받는다

- 해시테그 항목은 중복을 허용하면 안됨 ( 例: 건강 → Health 로 변경 시 찾아서 모두 고쳐야 함. )
- 해시태그 값으로 중복이 여러개가 입력되고 있음 ( `별도의 표`를 생성 해야함 )

- 카테고리 항목은 중복을 허용하면 안됨
- 카테고리 값으로 한개만 받는다

- 작성자 항목은 중복을 허용하면 안됨
- 작성자 값으로 한개만 받음

- 좋아요의 경우는 중복을 허용하면 안됨 ( `고민해보니, 생각보다 연결 된 곳이 많음.` )
- 좋아요 값으로 한개만 받음 ( `단순한 숫자가 아니라 통계적인 합산 값`이 들어감 )

- 조회수는 중복을 허용하면 안됨 ( `조회수도 표로 뽑으면 좋음`, `조회수도 단순한 숫자가 아니라, 통계적인 합산 값이 들어감` )
- 조회수 값으로 한개만 받음

#### 5.1 해시태그 표를 별도로 생성

- 게시글은 해시태그가 있다
- 해시태그는 게시글에 있다

- 하나의 게시글엔 여러개의 해시태그가 있다
- 여러개의 해시태그는 여러개의 게시글에 있다
  - 게시글 : 해시태그 = N : M 의 관계
  - N : M 일때는 중간 FK 를 모은 표가 필요함

#### 5.2 카테고리 표를 별도로 생성하기

- 게시글에는 카테고리가 있다
- 카테고리는 게시글에 표현된다

- 하나의 게시글에는 하나의 카테고리가 있다
- 하나의 카테고리는 여러 게시글에 표현 된다
  - 게시글 : 카테고리 = N : 1 의 관계
  - 표를 하나 추가한다
  - FK 는 N 테이블 (자리)에 작성함

#### 5.3 `좋아요 표` 별도로 생성하기

- 누가 좋아요를 눌렀는지 기록
- 어떤 게시글을 좋아요 눌렀는지 기록
- 하나의 칸에 여러개가 들어감 (규칙 위반)
- 값 넣어보기

  - 게시글에는 어떤 유저가 좋아요 했는지? 가 있다
  - 어떤 유저가 좋아요를 했는지 게시글에 있다
  - 하나의 게시글에는 여러명의 누가 좋아요 했는지 ? 가 있다
  - 한명의 사용자는 여러개의 게시글에 좋아요 할 수 있음

- 게시글과 좋아요 = N : M 의 관계 ( 고로, FK 표 생성)

#### 5.4 `조회수 표` 별도로 생성하기

- 누가 글을 읽었는지 기록,
- 어떤 게시글을 읽었는지 기록
- 하나의 칸에 여러개가 들어감. (규칙어긋남)
- 값을 한번 넣어보자.

  - 게시글에는 누가 읽었는지 있다.
  - 누가 읽었는지는 게시글에 있다.
  - 하나의 게시글에는 여러명의 읽을 수가 있다.
  - 한명의 사용자는 여러개의 게시글을 조회 할 수가 있다.
  - 게시글과 조회수 = N : M 이다.
  - 그래서 FK 를 모은 중간 테이블이 필요하다.

### 6. `팔로우 테이블` 테스트 하기

- 사용자는 다른 사용자를 팔로우 한다
- 사용자는 다른 사용자를 언팔로우 한다
- 한 명의 사용자는 여러명의 사용자를 팔로우 할 수 있다
- 여러명의 사용자는 한 명의 사용자를 팔로우 할 수 있다
  - 팔로워 : 언팔로워 = N : M 의 관계 ( FK 표 생성 )

### 7. `신고 테이블` 테스트 하기 (수업은 그대로 둠 - 원래는 `FK 표 생성` 해야함)

- 사용자는 다른 사용자를 신고 한다
- 다른 사용자는 사용자를 신고 한다
- 하나의 게시글은 여러명의 사용자가 신고 할 수 있다
- 여러명의 사용자는 하나의 게시글을 신고 할 수 있다

## 최종 테이블 구조

- `늘 변동 될 수 있음` 을 인지
- https://docs.google.com/spreadsheets/d/1PjX6Sepcg3nVyHcGmYTeMgkz_9uw-6aZZbLbqfhALtU/edit?usp=sharing